.rides.container-fluid{'ng-controller'=>'RidesController'}
  .row
    .col-sm-4.col-xs-12{ng:{include:'"/views/rides-tripplanner.html"'}}
    .col-sm-8.col-xs-12
      #rides-itineraries-list
        .ride_itineraries{ng:{repeat:"itinerary in itineraries | filter:itineraryFilter | orderBy:orderItinerariesBy:false", hide:'tripSelected && tripSelected != itinerary.id' }}
          .bordered
            .no-outline
              .row
                .col-sm-8.col-xs-9
                  .no-outline.icon
                    %img.ride-mode-service-icon{style:'vertical-align:bottom;', ng:{src:'{{itinerary.returned_mode_code | modeIcon: itinerary.logo_url}}'}}
                    %h2.ride-mode-service-name
                      {{itinerary.returned_mode_code | modeName: itinerary.service_name}}
                .col-sm-4.col-xs-12{style:'position:relative;'}
                  .btn.btn-primary.btn-block{ng:{click:'saveTrip(itinerary)', hide:'tripSelected'}}
                    Select
                  .btn.btn-primary.btn-block{ng:{click:'cancelTrip(itinerary)', show:'tripSelected'}}
                    Cancel
            .no-outline.top-border-hr
              .row
                .col-sm-3.col-xs-6.text-center
                  %h3
                    {{itinerary.cost | roundUp: itinerary.returned_mode_code | currency | free}}
                .col-sm-8.col-sm-offset-1.col-xs-12
                  %h3{style:'font-weight:normal'}
                    %span.start-end-time.text-nowrap {{itinerary.start_time | date : 'h:mm a'}} to
                    %span.start-end-time.text-nowrap {{itinerary.end_time | date : 'h:mm a'}}
              .row{style:'margin-bottom: 1em;'}
                .col-sm-8.col-xs-12
                  %h3{style:'margin: 0px;'}
                    %span.small.text-nowrap {{itinerary.duration | seconds}} travel time,
                    %span.small.text-nowrap {{itinerary.walk_time | seconds}} walking
                .col-sm-4.col-xs-12.text-center
                  .btn.btn-link{ng: {click: 'itinerary.showMoreDetails = !itinerary.showMoreDetails', hide:'tripSelected' } }
                    %span{ng:{hide:'itinerary.showMoreDetails'}}
                      More trip details
                    %span{ng:{show:'itinerary.showMoreDetails'}}
                      Close trip details
            .top-border-hr{ng: {show: 'itinerary.showMoreDetails'}}
              .included-template{ng:{ 'include'=>'itineraryTemplate( itinerary.returned_mode_code )' } }
              .email-or-cancel
                .email-itinerary-form{style:'margin:1em 0px;', ng: {show: 'showEmail'}}
                  .row
                    .col-xs-12.col-sm-8.col-sm-offset-2.text-left
                      Email your ride details to a friend (or yourself).
                  .row
                    .col-xs-12.col-sm-8.col-sm-offset-2.text-left.text-muted
                      Use a comma to separate multiple addresses
                  .row
                    .col-sm-6.col-sm-offset-2.col-xs-8{'style' => 'line-height: 2em; padding-right: 0px;'}
                      %input.form-control{type:'text', style: 'font-size: .9em; border-top-right-radius:0px; border-bottom-right-radius:0px;', ng: {model: 'emailAddresses.text'}}
                    .col-sm-2.col-xs-10{'style' => 'line-height: 2em; padding-left: 0px;'}
                      .btn.btn-success.btn-block{style: 'padding-left: 0px; padding-right: 0px;min-width: 20px; border-top-left-radius:0px; border-bottom-left-radius:0px;', ng: {click: 'sendEmail(itinerary)'}}
                        %i.fa.fa-envelope-o.fa-lg{style:'color: white;'}
                          %span
                            Send
                  .row{ng: {show: 'invalidEmail == true'}}
                    .col-xs-12.col-sm-8.col-sm-offset-2.text-left{style: 'color: red'}
                      Please enter only valid email addresses
                .service_login_form.row{ng:{show:'showServiceLoginForm'}}
                  %form.col-md-6.col-md-offset-3.col-xs-12{name:"service_login_form", role:"form", method:"post", action:"service_login", "accept-charset"=>"UTF-8"}
                    .form-group
                      %label.sr-only{for:"service-username"}
                        Username
                      %input#service-username.form-control{type:"text", placeholder:"Username", "ng-model"=>"service_username.text", required:'', name:'service_username'}
                      .alert{role:'alert', "ng-show"=>"signupform.service_uesrname.$error.required"}
                        .error
                          Required
                    .form-group
                      %label.sr-only{for:"service-password"}
                        Password
                      %input#service-password.form-control{type:"password", placeholder:"Password", "ng-model"=>"service_password.text", required:'', name:'service_password'}
                      .alert{role:'alert', "ng-show"=>"signupform.service_password.$error.required"}
                        .error
                          Required
                    .form-group
                      .btn.btn-success.btn-block{ng:{click:'serviceLogin(itinerary.service_id)'}}
                        Login
                .prebooking_questions{ng:{show:'showPrebookingQuestions'}}
                  %form{name:'prebooking_questions', role:'form'}
                    .row{ng:{repeat:'question in itinerary.prebooking_questions'}}
                      .col-xs-6
                        {{question.question}}
                      .col-xs-6
                        .included-question{ng:{include:'prebookingQuestionTemplate(question.choices)'}}
                    .row
                      .col-md-6.col-md-offset-3.col-xs-12
                        .btn.btn-block.btn-primary{ng:{click:'answerPrebookQuestions(itinerary)'}}
                          Continue
                .action-buttons{ng:{show:'tripSelected == itinerary.id && !showServiceLoginForm && !showPrebookingQuestions'}}
                  .row.not_bookable{ng: {hide: 'itinerary.service_bookable'}}
                    .col-md-4.col-md-offset-4.col-xs-10.col-xs-offset-1
                      .btn.btn-primary.btn-block{ng:{click:'showEmail || toggleEmail()', class:'{disabled:showEmail}'}}
                        {{'email_button' | translate}}
                  .row.bookable{ng: {show: 'itinerary.service_bookable'}}
                    .col-md-4.col-md-offset-2.col-xs-6
                      .btn.btn-primary.btn-block{ng:{click:'showEmail || toggleEmail()', class:'{disabled:showEmail}'}}
                        {{'email_button' | translate}}
                    .col-md-4.col-xs-6
                      .btn.btn-primary.btn-block{ng:{click:'bookItinerary(itinerary)'}}
                        {{'book_button' | translate}}
      #rides-itineraries-loading.fade.in{'ng-show'=>'updatingResults', style:'position:absolute; top:0px;'}
        %h3{style:'margin-top:30px;'}
          Finding Rides...
        .sk-circle
          .sk-circle1.sk-child
          .sk-circle2.sk-child
          .sk-circle3.sk-child
          .sk-circle4.sk-child
          .sk-circle5.sk-child
          .sk-circle6.sk-child
          .sk-circle7.sk-child
          .sk-circle8.sk-child
          .sk-circle9.sk-child
          .sk-circle10.sk-child
          .sk-circle11.sk-child
          .sk-circle12.sk-child

